/* FullCalendar v1.4.6 http://arshaw.com/fullcalendar/ Use fullcalendar.css for basic styling. For event drag & drop, required jQuery UI draggable. For event resizing, requires jQuery UI resizable. Copyright (c) 2009 Adam Shaw Dual licensed under the MIT and GPL licenses: http://www.opensource.org/licenses/mit-license.php http://www.gnu.org/licenses/gpl.html Date: Mon May 31 10:18:29 2010 -0700 */ (function(h){function ca(a,b){a._id=a._id||(a.id===x?"_fc"+Ta++:a.id+"");a.date&&(a.start||(a.start=a.date),delete a.date);a._start=l(a.start=Ea(a.start));a.end=Ea(a.end);a.end&&a.end<=a.start&&(a.end=null);a._end=a.end?l(a.end):null;a.allDay===x&&(a.allDay=b.allDayDefault);a.className?"string"==typeof a.className&&(a.className=a.className.split(/\s+/)):a.className=[]}function ra(a,b,d){function c(){z._clearEvents();t.empty()}function e(a){var b=l(z.visStart),c=m(l(b),u),d=h.map(a,ka),e,g,f,n,j,p, q=[];for(e=0;e<v;e++){g=sa(z.sliceSegs(a,d,b,c));for(f=0;f<g.length;f++){n=g[f];for(j=0;j<n.length;j++)p=n[j],p.row=e,p.level=f,q.push(p)}m(b,7);m(c,7)}return q}function g(a,b){Fa(a,v,z,0,L,function(a){return H.find("tr:eq("+a+")")},Q.left,Q.right,t,f,b)}function f(a,c,d){z.eventElementHandlers(a,c);if(a.editable||a.editable===x&&b.editable){if(!b.disableDragging&&c.draggable){var e,g=0;c.draggable({zIndex:9,delay:50,opacity:z.option("dragOpacity"),revertDuration:b.dragRevertDuration,start:function(b, d){z.hideEvents(a,c);z.trigger("eventDragStart",c,a,b,d);e=T(function(b){c.draggable("option","revert",!b||!b.rowDelta&&!b.colDelta);p();b?(g=7*b.rowDelta+b.colDelta*M,y(e,m(l(a.start),g),m(ka(a),g))):g=0});e.mouse(b)},drag:function(a){e.mouse(a)},stop:function(b,d){p();z.trigger("eventDragStop",c,a,b,d);g?(c.find("a").removeAttr("href"),z.eventDrop(this,a,g,0,a.allDay,b,d)):(h.browser.msie&&c.css("filter",""),z.showEvents(a,c))}})}d.isEnd&&z.resizableDayEvent(a,c,C)}}function F(a){if(!z.option("selectable")){var b= parseInt(this.className.match(/fc\-day(\d+)/)[1]),b=m(l(z.visStart),7*Math.floor(b/u)+b%u);z.trigger("dayClick",this,b,!0,a)}}function da(a){if(z.option("selectable"))return U=T(function(a){a?(a=m(l(z.visStart),7*a.row+a.col*M+J),k.drag(a,a,!0)):k.drag()}),ta(function(a){U.mouse(a)},function(a){k.dragStop(a)}),k.dragStart(a),U.mouse(a),!1}function j(){k.unselect()}function y(b,c,d){for(var e=l(z.visStart),g=m(l(e),u),f=0;f<v;f++){var h=new Date(Math.max(e,c)),n=new Date(Math.min(g,d));if(h<n){var j; w?(j=V(n,e)*M+J+1,h=V(h,e)*M+J+1):(j=V(h,e),h=V(n,e));j=b.rect(f,j,f+1,h,a);z.renderOverlay(j,a).click(F).mousedown(da)}m(e,7);m(g,7)}}function p(){z.clearOverlays()}function T(a){var b=H.find("tr:first td");w&&(b=h(b.get().reverse()));return new na(H.find("tr"),b,a)}var q,Ga,r,w,M,J,L,D,v,u,C,E,H,B=[],t,Q=new Ha(function(a){return H.find("td:eq("+(a-Math.max(Ga,r)+u)%u+") div div")}),k,U,z=h.extend(this,Ia,d,{renderGrid:function(d,e,g,f){v=d;u=e;q=b.theme?"ui":"fc";r=b.weekends?0:1;Ga=b.firstDay; (w=b.isRTL)?(M=-1,J=u-1):(M=1,J=0);var j=z.start.getMonth(),p=ha(new Date),k,n=l(z.visStart);if(H){c();e=H.find("tr").length;if(v<e)H.find("tr:gt("+(v-1)+")").remove();else if(v>e){for(d="";e<v;e++){d+="<tr class='fc-week"+e+"'>";for(k=0;k<u;k++)d+="<td class='fc-"+W[n.getDay()]+" "+q+"-state-default fc-new fc-day"+(e*u+k)+(k==J?" fc-leftmost":"")+"'>"+(f?"<div class='fc-day-number'></div>":"")+"<div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></td>",m(n,1),r&&K(n);d+= "</tr>"}H.append(d)}H.find("td.fc-new").removeClass("fc-new").click(F).mousedown(da);n=l(z.visStart);H.find("td").each(function(){var a=h(this);1<v&&(n.getMonth()==j?a.removeClass("fc-other-month"):a.addClass("fc-other-month"));+n==+p?a.removeClass("fc-not-today").addClass("fc-today").addClass(q+"-state-highlight"):a.addClass("fc-not-today").removeClass("fc-today").removeClass(q+"-state-highlight");a.find("div.fc-day-number").text(n.getDate());m(n,1);r&&K(n)});1==v&&(n=l(z.visStart),E.find("th").each(function(){h(this).text(S(n, g,b));this.className=this.className.replace(/^fc-\w+(?= )/,"fc-"+W[n.getDay()]);m(n,1);r&&K(n)}),n=l(z.visStart),H.find("td").each(function(){this.className=this.className.replace(/^fc-\w+(?= )/,"fc-"+W[n.getDay()]);m(n,1);r&&K(n)}))}else{var Y=h("<table/>").appendTo(a);d="<thead><tr>";for(e=0;e<u;e++)d+="<th class='fc-"+W[n.getDay()]+" "+q+"-state-default"+(e==J?" fc-leftmost":"")+"'>"+S(n,g,b)+"</th>",m(n,1),r&&K(n);E=h(d+"</tr></thead>").appendTo(Y);d="<tbody>";n=l(z.visStart);for(e=0;e<v;e++){d+= "<tr class='fc-week"+e+"'>";for(k=0;k<u;k++)d+="<td class='fc-"+W[n.getDay()]+" "+q+"-state-default fc-day"+(e*u+k)+(k==J?" fc-leftmost":"")+(1<v&&n.getMonth()!=j?" fc-other-month":"")+(+n==+p?" fc-today "+q+"-state-highlight":" fc-not-today")+"'>"+(f?"<div class='fc-day-number'>"+n.getDate()+"</div>":"")+"<div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></td>",m(n,1),r&&K(n);d+="</tr>"}H=h(d+"</tbody>").appendTo(Y);H.find("td").click(F).mousedown(da);t=h("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(a)}}, renderEvents:function(a){z.reportEvents(B=a);g(e(a))},rerenderEvents:function(a){c();g(e(B),a)},clearEvents:c,setHeight:function(a){D=a;a=H.find("tr td:first-child");var d=D-E.height(),c;"variable"==b.weekMode?c=d=Math.floor(d/(1==v?2:6)):(c=Math.floor(d/v),d-=c*(v-1));if(ua===x){var e=H.find("tr:first").find("td:first");e.height(c);ua=c!=e.height()}ua?(a.slice(0,-1).height(c),a.slice(-1).height(d)):(oa(a.slice(0,-1),c),oa(a.slice(-1),d))},setWidth:function(a){L=a;Q.clear();ia(E.find("th").slice(0, -1),C=Math.floor(L/u))},defaultEventEnd:function(a){return l(a.start)}});z.init(a,b);Ja(a.addClass("fc-grid"));k=new va(z,j,function(a,b){y(U,a,m(l(b),1))},p);Ka(z,j);z.select=function(a,b,d){b||(b=l(a));U=T();k.select(a,b,d)};z.unselect=j}function Fa(a,b,d,c,e,g,f,l,m,j,y){var p=d.options,T=p.isRTL,q,E=a.length,r,w,M,J,L,D="",v={},u={},C=[],K=[];for(q=0;q<E;q++)r=a[q],w=r.event,M="fc-event fc-event-hori ",T?(r.isStart&&(M+="fc-corner-right "),r.isEnd&&(M+="fc-corner-left "),J=r.isEnd?f(r.end.getDay()- 1):c,L=r.isStart?l(r.start.getDay()):e):(r.isStart&&(M+="fc-corner-left "),r.isEnd&&(M+="fc-corner-right "),J=r.isStart?f(r.start.getDay()):c,L=r.isEnd?l(r.end.getDay()-1):e),D+="<div class='"+M+w.className.join(" ")+"' style='position:absolute;z-index:8;left:"+J+"px'><a"+(w.url?" href='"+ja(w.url)+"'":"")+">"+(!w.allDay&&r.isStart?"<span class='fc-event-time'>"+ja(ea(w.start,w.end,d.option("timeFormat"),p))+"</span>":"")+"<span class='fc-event-title'>"+ja(w.title)+"</span></a>"+((w.editable||w.editable=== x&&p.editable)&&!p.disableResizing&&h.fn.resizable?"<div class='ui-resizable-handle ui-resizable-"+(T?"w":"e")+"'></div>":"")+"</div>",r.left=J,r.outerWidth=L-J;m[0].innerHTML=D;e=m.children();for(q=0;q<E;q++)r=a[q],c=h(e[q]),w=r.event,f=d.trigger("eventRender",w,w,c),!1===f?c.remove():(f&&!0!==f&&(c.remove(),c=h(f).css({position:"absolute",left:r.left}).appendTo(m)),r.element=c,w._id===y?j(w,c,r):c[0]._fci=q,d.reportEventElement(w,c));La(m,a,j);for(q=0;q<E;q++)if(r=a[q],c=r.element)j=v[m=r.key=Ma(c[0])], r.hsides=j===x?v[m]=wa(c[0],!0):j;for(q=0;q<E;q++)if(r=a[q],c=r.element)c[0].style.width=r.outerWidth-r.hsides+"px";for(q=0;q<E;q++)if(r=a[q],c=r.element)j=u[m=r.key],r.outerHeight=c[0].offsetHeight+(j===x?u[m]=Na(c[0]):j);for(v=q=0;v<b;v++){for(u=m=j=0;q<E&&(r=a[q]).row==v;)r.level!=m&&(u+=j,j=0,m++),j=Math.max(j,r.outerHeight||0),r.top=u,q++;C[v]=g(v).find("td:first div.fc-day-content > div").height(u+j)}for(v=0;v<b;v++)K[v]=C[v][0].offsetTop;for(q=0;q<E;q++)if(r=a[q],c=r.element)c[0].style.top= K[r.row]+r.top+"px",w=r.event,d.trigger("eventAfterRender",w,w,c)}function Oa(a,b,d){function c(a,d){k=a;xa={};L.height(a-J.height());t=L.find("tr:first div").height()+1;u.css({top:J.find("tr").height(),height:a});if(d){var c=Pa(),e=l(c);e.setHours(b.firstHour);var n=r(c,e)+1,c=function(){L.scrollTop(n)};c();setTimeout(c,0)}}function e(a){if(!s.option("selectable")){var c=Math.floor((a.pageX-u.offset().left)/B),c=m(l(s.visStart),n+I*c),d=this.className.match(/fc-slot(\d+)/);d?(d=parseInt(d[1])*b.slotMinutes, c.setHours(Math.floor(d/60)),c.setMinutes(d%60+Y),s.trigger("dayClick",this,c,!1,a)):s.trigger("dayClick",this,c,!0,a)}}function g(a,d){s.reportEvents(z=a);var e,g=a.length,f=[],p=[];for(e=0;e<g;e++)a[e].allDay?f.push(a[e]):p.push(a[e]);e=sa(s.sliceSegs(f,h.map(f,ka),s.visStart,s.visEnd));for(var f=e.length,q,v,G,A=[],g=0;g<f;g++){q=e[g];for(v=0;v<q.length;v++)G=q[v],G.row=0,G.level=g,A.push(G)}b.allDaySlot&&(Fa(A,1,s,H,Z,function(){return J.find("tr.fc-all-day")},function(a){return H+la.left((a- Math.max(ba,$)+C)%C*I+n)},function(a){return H+la.right((a-Math.max(ba,$)+C)%C*I+n)},N,da,d),c(k));var g=E(l(s.visStart),Y),f=h.map(p,M),t,u;e=[];for(q=0;q<C;q++){G=v=sa(s.sliceSegs(p,f,g,E(l(g),ma-Y)));for(var O=u=t=A=void 0,y=void 0,w=void 0,A=G.length-1;0<A;A--){O=G[A];for(t=0;t<O.length;t++){y=O[t];for(u=0;u<G[A-1].length;u++)w=G[A-1][u],y.end>w.start&&y.start<w.end&&(w.forward=Math.max(w.forward||0,(y.forward||0)+1))}}for(G=0;G<v.length;G++){A=v[G];for(t=0;t<A.length;t++)u=A[t],u.col=q,u.level= G,e.push(u)}m(g,1,!0)}var g=e.length,D,T,B,O="";q={};v={};for(p=0;p<g;p++)f=e[p],G=f.event,A="fc-event fc-event-vert ",f.isStart&&(A+="fc-corner-top "),f.isEnd&&(A+="fc-corner-bottom "),t=r(f.start,f.start),u=r(f.start,f.end),D=f.col,y=f.level,w=f.forward||0,T=H+la.left(D*I+n),B=H+la.right(D*I+n)-T,B=Math.min(B-6,0.95*B),D=y?B/(y+w+1):w?2*(B/(w+1)-6):B,y=T+B/(y+w+1)*y*I+(R?B-D:0),f.top=t,f.left=y,f.outerWidth=D,f.outerHeight=u-t,O+=F(G,f,A);X[0].innerHTML=O;t=X.children();for(p=0;p<g;p++)f=e[p],G= f.event,A=h(t[p]),u=s.trigger("eventRender",G,G,A),!1===u?A.remove():(u&&!0!==u&&(A.remove(),A=h(u).css({position:"absolute",top:f.top,left:f.left}).appendTo(X)),f.element=A,G._id===d?j(G,A,f):A[0]._fci=p,s.reportEventElement(G,A));La(X,e,j);for(p=0;p<g;p++)if(f=e[p],A=f.element)t=q[G=f.key=Ma(A[0])],f.vsides=t===x?q[G]=ya(A[0],!0):t,t=v[G],f.hsides=t===x?v[G]=wa(A[0],!0):t,G=A.find("span.fc-event-title"),G.length&&(f.titleTop=G[0].offsetTop);for(p=0;p<g;p++)if(f=e[p],A=f.element)A[0].style.width= f.outerWidth-f.hsides+"px",A[0].style.height=(q=f.outerHeight-f.vsides)+"px",G=f.event,f.titleTop!==x&&10>q-f.titleTop&&(A.find("span.fc-event-time").text(S(G.start,s.option("timeFormat"))+" - "+G.title),A.find("span.fc-event-title").remove()),s.trigger("eventAfterRender",G,G,A)}function f(){s._clearEvents();N.empty();X.empty()}function F(a,d,c){return"<div class='"+c+a.className.join(" ")+"' style='position:absolute;z-index:8;top:"+d.top+"px;left:"+d.left+"px'><a"+(a.url?" href='"+ja(a.url)+"'": "")+"><span class='fc-event-bg'></span><span class='fc-event-time'>"+ja(ea(a.start,a.end,s.option("timeFormat")))+"</span><span class='fc-event-title'>"+ja(a.title)+"</span></a>"+((a.editable||a.editable===x&&b.editable)&&!b.disableResizing&&h.fn.resizable?"<div class='ui-resizable-handle ui-resizable-s'>=</div>":"")+"</div>"}function da(a,d,c){s.eventElementHandlers(a,d);if(a.editable||a.editable===x&&b.editable){var e=c.isStart;if(!b.disableDragging&&d.draggable){var g,n,f,p=!0,j;d.draggable({zIndex:9, opacity:s.option("dragOpacity","month"),revertDuration:b.dragRevertDuration,start:function(c,h){s.hideEvents(a,d);s.trigger("eventDragStart",d,a,c,h);g=d.position();n=d.width();f=function(){p||(d.width(n).height("").draggable("option","grid",null),p=!0)};j=w(function(c){d.draggable("option","revert",!c||!c.rowDelta&&!c.colDelta);s.clearOverlays();c&&(c.row?e&&p&&(oa(d.width(B-10),t*Math.round((a.end?(a.end-a.start)/Ua:b.defaultEventMinutes)/b.slotMinutes)),d.draggable("option","grid",[B,1]),p=!1): (Q(j,m(l(a.start),c.colDelta),m(ka(a),c.colDelta)),f()))},!0);j.mouse(c)},drag:function(a){j.mouse(a)},stop:function(c,e){s.trigger("eventDragStop",d,a,c,e);s.clearOverlays();var n=j.cell,l=I*(p?n?n.colDelta:0:Math.floor((e.position.left-g.left)/B));!n||!l&&!n.rowDelta?(f(),h.browser.msie&&d.css("filter",""),s.showEvents(a,d)):(d.find("a").removeAttr("href"),s.eventDrop(this,a,l,p?0:Math.round((d.offset().top-D.offset().top)/t)*b.slotMinutes+Y-(60*a.start.getHours()+a.start.getMinutes()),p,c,e))}})}c.isEnd&& s.resizableDayEvent(a,d,B)}}function j(a,d,c){s.eventElementHandlers(a,d);if(a.editable||a.editable===x&&b.editable){var e=d.find("span.fc-event-time");if(!b.disableDragging&&d.draggable){var n,g,f,p,j=!1,q;d.draggable({zIndex:9,scroll:!1,grid:[B,t],axis:1==C?"y":!1,opacity:s.option("dragOpacity"),revertDuration:b.dragRevertDuration,start:function(c,p){s.hideEvents(a,d);s.trigger("eventDragStart",d,a,c,p);h.browser.msie&&d.find("span.fc-event-bg").hide();n=d.position();g=function(){j&&(e.css("display", ""),d.draggable("option","grid",[B,t]),j=!1)};f=0;q=w(function(c){d.draggable("option","revert",!c);s.clearOverlays();c&&(!c.row&&b.allDaySlot?(j||(j=!0,e.hide(),d.draggable("option","grid",null)),Q(q,m(l(a.start),c.colDelta),m(ka(a),c.colDelta))):g())},!0);q.mouse(c)},drag:function(d,c){p=Math.round((c.position.top-n.top)/t);if(p!=f){if(!j){var g=p*b.slotMinutes,h=E(l(a.start),g),k;a.end&&(k=E(l(a.end),g));e.text(ea(h,k,s.option("timeFormat")))}f=p}q.mouse(d)},stop:function(c,e){s.clearOverlays(); s.trigger("eventDragStop",d,a,c,e);var f=q.cell,l=I*(j?f?f.colDelta:0:Math.floor((e.position.left-n.left)/B));!f||!p&&!l?(g(),h.browser.msie&&d.css("filter","").find("span.fc-event-bg").css("display",""),d.css(n),s.showEvents(a,d)):s.eventDrop(this,a,l,j?0:p*b.slotMinutes,j,c,e)}})}if(c.isEnd&&!b.disableResizing&&d.resizable){var k,r;d.resizable({handles:{s:"div.ui-resizable-s"},grid:t,start:function(b,c){k=r=0;s.hideEvents(a,d);h.browser.msie&&"6.0"==h.browser.version&&d.css("overflow","hidden"); d.css("z-index",9);s.trigger("eventResizeStart",this,a,b,c)},resize:function(c,n){k=Math.round((Math.max(t,d.height())-n.originalSize.height)/t);k!=r&&(e.text(ea(a.start,!k&&!a.end?null:E(s.eventEnd(a),b.slotMinutes*k),s.option("timeFormat"))),r=k)},stop:function(c,e){s.trigger("eventResizeStop",this,a,c,e);k?s.eventResize(this,a,0,b.slotMinutes*k,c,e):(d.css("z-index",8),s.showEvents(a,d))}})}}}function y(a){if(s.option("selectable"))return aa=w(function(a){a?(a=m(l(s.visStart),a.col*I+n),fa.drag(a, a,!0)):fa.drag()}),ta(function(a){aa.mouse(a)},function(a){fa.dragStop(a)}),fa.dragStart(a),aa.mouse(a),!1}function p(a){if(s.option("selectable"))return aa=new na(v.find("td"),u.find("td"),function(a){if(a){var d=a.row;a=m(l(s.visStart),a.origCol*I+n);E(a,Y+d*b.slotMinutes);ga.drag(a,E(l(a),b.slotMinutes),!1)}else ga.drag()}),ta(function(a){aa.mouse(a)},function(a){ga.dragStop(a)}),ga.dragStart(a),aa.mouse(a),!1}function T(){ga.unselect();fa.unselect()}function q(){s.clearOverlays();O&&(O.remove(), O=null)}function Q(a,b,d){var c;R?(c=V(d,s.visStart)*I+n+1,b=V(b,s.visStart)*I+n+1):(c=V(b,s.visStart),b=V(d,s.visStart));c=Math.max(0,c);b=Math.min(C,b);c<b&&(a=a.rect(0,c,1,b,J),s.renderOverlay(a,J).click(e).mousedown(y))}function r(a,d){a=l(a,!0);if(d<E(l(a),Y))return 0;if(d>=E(l(a),ma))return D.height();var c=b.slotMinutes,e=60*d.getHours()+d.getMinutes()-Y,n=Math.floor(e/c),g=xa[n];g===x&&(g=xa[n]=L.find("tr:eq("+n+") td div")[0].offsetTop);return Math.max(0,Math.round(g-1+t*(e%c/c)))}function w(a, d){var c=b.allDaySlot?J.find("td"):h([]);d&&(c=c.add(L));return new na(c,u.find("td"),a)}function M(a){return a.end?l(a.end):E(l(a.start),b.defaultEventMinutes)}var J,L,D,v,u,C,ca=0,H,B,t,Z,k,U,z=[],N,X,P,ba,$,R,I,n,Y,ma,la=new Ha(function(a){return u.find("td:eq("+a+") div div")}),xa={},fa,ga,O,aa,s=h.extend(this,Ia,d,{renderAgenda:function(d,c){C=d;P=b.theme?"ui":"fc";$=b.weekends?0:1;ba=b.firstDay;(R=b.isRTL)?(I=-1,n=C-1):(I=1,n=0);Y=Qa(b.minTime);ma=Qa(b.maxTime);var g=R?m(l(s.visEnd),-1):l(s.visStart), j=l(g),q=ha(new Date);if(J)f(),J.find("tr:first th").slice(1,-1).each(function(){h(this).text(S(j,c,b));this.className=this.className.replace(/^fc-\w+(?= )/,"fc-"+W[j.getDay()]);m(j,I);$&&K(j,I)}),j=l(g),u.find("td").each(function(){this.className=this.className.replace(/^fc-\w+(?= )/,"fc-"+W[j.getDay()]);+j==+q?h(this).removeClass("fc-not-today").addClass("fc-today").addClass(P+"-state-highlight"):h(this).addClass("fc-not-today").removeClass("fc-today").removeClass(P+"-state-highlight");m(j,I);$&& K(j,I)});else{var k,r,t=0==b.slotMinutes%15,F="<div class='fc-agenda-head' style='position:relative;z-index:4'><table style='width:100%'><tr class='fc-first"+(b.allDaySlot?"":" fc-last")+"'><th class='fc-leftmost "+P+"-state-default'>&nbsp;</th>";for(k=0;k<C;k++)F+="<th class='fc-"+W[j.getDay()]+" "+P+"-state-default'>"+S(j,c,b)+"</th>",m(j,I),$&&K(j,I);F+="<th class='"+P+"-state-default'>&nbsp;</th></tr>";b.allDaySlot&&(F+="<tr class='fc-all-day'><th class='fc-axis fc-leftmost "+P+"-state-default'>"+ b.allDayText+"</th><td colspan='"+C+"' class='"+P+"-state-default'><div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></td><th class='"+P+"-state-default'>&nbsp;</th></tr><tr class='fc-divider fc-last'><th colspan='"+(C+2)+"' class='"+P+"-state-default fc-leftmost'><div/></th></tr>");J=h(F+"</table></div>").appendTo(a);J.find("td").click(e).mousedown(y);N=h("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(J);var j=Pa(),da=E(l(j),ma);E(j,Y);F="<table>"; for(k=0;j<da;k++)r=j.getMinutes(),F+="<tr class='"+(!k?"fc-first":!r?"":"fc-minor")+"'><th class='fc-axis fc-leftmost "+P+"-state-default'>"+(!t||!r?S(j,b.axisFormat):"&nbsp;")+"</th><td class='fc-slot"+k+" "+P+"-state-default'><div style='position:relative'>&nbsp;</div></td></tr>",E(j,b.slotMinutes),ca++;F+="</table>";L=h("<div class='fc-agenda-body' style='position:relative;z-index:2;overflow:auto'/>").append(D=h("<div style='position:relative;overflow:hidden'>").append(v=h(F))).appendTo(a);L.find("td").click(e).mousedown(p); X=h("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(D);j=l(g);F="<div class='fc-agenda-bg' style='position:absolute;z-index:1'><table style='width:100%;height:100%'><tr class='fc-first'>";for(k=0;k<C;k++)F+="<td class='fc-"+W[j.getDay()]+" "+P+"-state-default "+(!k?"fc-leftmost ":"")+(+j==+q?P+"-state-highlight fc-today":"fc-not-today")+"'><div class='fc-day-content'><div>&nbsp;</div></div></td>",m(j,I),$&&K(j,I);F+="</tr></table></div>";u=h(F).appendTo(a)}},renderEvents:g,rerenderEvents:function(a){f(); g(z,a)},clearEvents:f,setHeight:c,setWidth:function(a){Z=a;la.clear();L.width(a);v.width("");a=J.find("tr:first th");var b=u.find("td"),d=L[0].clientWidth;v.width(d);H=0;ia(J.find("tr:lt(2) th:first").add(L.find("tr:first th")).width("").each(function(){H=Math.max(H,h(this).outerWidth())}),H);B=Math.floor((d-H)/C);ia(b.slice(0,-1),B);ia(a.slice(1,-2),B);ia(a.slice(-2,-1),d-H-B*(C-1));u.css({left:H,width:d-H})},beforeHide:function(){U=L.scrollTop()},afterShow:function(){L.scrollTop(U)},defaultEventEnd:function(a){var d= l(a.start);return a.allDay?d:E(d,b.defaultEventMinutes)}});s.init(a,b);Ja(a.addClass("fc-agenda"));fa=new va(s,T,function(a,b){Q(aa,a,m(l(b),1))},q);ga=new va(s,T,function(a,b){var d=s.option("selectHelper");if(d){var c=V(a,s.visStart);if(0<=c&&c<C){var c=aa.rect(0,c*I+n,1,c*I+n+1,D),g=r(a,a),f=r(a,b);if(f>g){c.top=g;c.height=f-g;c.left+=2;c.width-=5;if(h.isFunction(d)){if(d=d(a,b))c.position="absolute",c.zIndex=8,O=h(d).css(c).appendTo(D)}else O=h(F({title:"",start:a,end:b,className:[],editable:!1}, c,"fc-event fc-event-vert fc-corner-top fc-corner-bottom ")),h.browser.msie&&O.find("span.fc-event-bg").hide(),O.css("opacity",s.option("dragOpacity"));O&&(O.click(e).mousedown(p),D.append(O),ia(O,c.width,!0),oa(O,c.height,!0))}}}else{d=aa;c=l(s.visStart);g=m(l(c),1);for(f=0;f<C;f++){var j=new Date(Math.max(c,a)),k=new Date(Math.min(g,b));if(j<k){var q=d.rect(0,f*I+n,1,f*I+n+1,D),j=r(c,j),k=r(c,k);q.top=j;q.height=k-j;s.renderOverlay(q,D).click(e).mousedown(p)}m(c,1);m(g,1)}}},q);Ka(s,T);this.select= function(a,c,d){d?b.allDaySlot&&(c||(c=l(a)),aa=w(),fa.select(a,c,d)):(c||(c=E(l(a),b.slotMinutes)),aa=new na(v.find("td"),u.find("td"),void 0),ga.select(a,c,d))};this.unselect=T}function La(a,b,d){a.unbind("mouseover").mouseover(function(a){for(var e=a.target,g;e!=this;)g=e,e=e.parentNode;if((e=g._fci)!==x)g._fci=x,g=b[e],d(g.event,g.element,g),h(a.target).trigger(a);a.stopPropagation()})}function sa(a){var b=[],d,c=a.length,e,g,f,h;for(d=0;d<c;d++){e=a[d];for(g=0;;){f=!1;if(b[g])for(h=0;h<b[g].length;h++)if(b[g][h].end> e.start&&b[g][h].start<e.end){f=!0;break}if(f)g++;else break}b[g]?b[g].push(e):b[g]=[e]}return b}function Va(a,b){return 100*(b.msLength-a.msLength)+(a.event.start-b.event.start)}function va(a,b,d,c){function e(){g=!0;a.trigger("select",a,m,j,y)}var g=!1,f,h,m,j,y;this.dragStart=function(a){b();h=m=j=x;f=a.currentTarget};this.drag=function(a,b,e){a?(a=[a,b],h||(h=a),a=h.concat(a).sort(Wa),m=a[0],j=a[3],y=e,c(),d(l(m),l(j),y)):(m=j=x,c())};this.dragStop=function(b){m&&(+h[0]==+m&&+h[1]==+j&&a.trigger("dayClick", f,m,y,b),e())};this.select=function(a,c,g){b();m=a;j=c;y=g;d(l(m),l(j),y);e()};this.unselect=function(){g&&(g=!1,m=j=x,c(),a.trigger("unselect",a))}}function ta(a,b){function d(c){b(c);h(document).unbind("mousemove",a).unbind("mouseup",d)}h(document).mousemove(a).mouseup(d)}function Ka(a,b){a.option("selectable")&&a.option("unselectAuto")&&h(document).mousedown(function(d){var c=a.option("unselectCancel");(!c||!h(d.target).parents(c).length)&&b()})}function za(a,b,d){a.setFullYear(a.getFullYear()+ b);d||ha(a);return a}function Aa(a,b,d){if(+a){b=a.getMonth()+b;var c=l(a);c.setDate(1);c.setMonth(b);a.setMonth(b);for(d||ha(a);a.getMonth()!=c.getMonth();)a.setDate(a.getDate()+(a<c?1:-1))}return a}function m(a,b,d){if(+a){b=a.getDate()+b;var c=l(a);c.setHours(9);c.setDate(b);a.setDate(b);d||ha(a);Ba(a,c)}return a}function Ba(a,b){if(+a)for(;a.getDate()!=b.getDate();)a.setTime(+a+(a<b?1:-1)*Xa)}function E(a,b){a.setMinutes(a.getMinutes()+b);return a}function ha(a){a.setHours(0);a.setMinutes(0); a.setSeconds(0);a.setMilliseconds(0);return a}function l(a,b){return b?ha(new Date(+a)):new Date(+a)}function Pa(){var a=0,b;do b=new Date(1970,a++,1);while(b.getHours());return b}function K(a,b,d){for(b=b||1;!a.getDay()||d&&1==a.getDay()||!d&&6==a.getDay();)m(a,b);return a}function V(a,b){return Math.round((l(a,!0)-l(b,!0))/Ra)}function ia(a,b,d){a.each(function(a,e){e.style.width=b-wa(e,d)+"px"})}function oa(a,b,d){a.each(function(a,e){e.style.height=b-ya(e,d)+"px"})}function wa(a,b){return(parseFloat(jQuery.curCSS(a, "paddingLeft",!0))||0)+(parseFloat(jQuery.curCSS(a,"paddingRight",!0))||0)+(parseFloat(jQuery.curCSS(a,"borderLeftWidth",!0))||0)+(parseFloat(jQuery.curCSS(a,"borderRightWidth",!0))||0)+(b?(parseFloat(jQuery.curCSS(a,"marginLeft",!0))||0)+(parseFloat(jQuery.curCSS(a,"marginRight",!0))||0):0)}function ya(a,b){return(parseFloat(jQuery.curCSS(a,"paddingTop",!0))||0)+(parseFloat(jQuery.curCSS(a,"paddingBottom",!0))||0)+(parseFloat(jQuery.curCSS(a,"borderTopWidth",!0))||0)+(parseFloat(jQuery.curCSS(a, "borderBottomWidth",!0))||0)+(b?Na(a):0)}function Na(a){return(parseFloat(jQuery.curCSS(a,"marginTop",!0))||0)+(parseFloat(jQuery.curCSS(a,"marginBottom",!0))||0)}function Ca(a,b){b="number"==typeof b?b+"px":b;a[0].style.cssText+=";min-height:"+b+";_height:"+b}function Ya(a){if(!1!==pa){var b;a.is("th,td")&&(a=(b=a).parent());pa===x&&a.is("tr")&&(pa=a.position().top!=a.children().position().top);if(pa)return a.parent().position().top+(b?a.position().top-b.position().top:0)}return 0}function na(a, b,d){var c=this,e=[],g=[],f,l,m,j,y;h.each(a,function(a,b){y=h(b);e.push(y.offset().top+Ya(y))});e.push(e[e.length-1]+y.outerHeight());h.each(b,function(a,b){y=h(b);g.push(y.offset().left)});g.push(g[g.length-1]+y.outerWidth());c.mouse=function(a){var b=a.pageX,h=a.pageY;for(a=0;a<e.length&&h>=e[a];a++);for(h=0;h<g.length&&b>=g[h];h++);a=a>=e.length?-1:a-1;h=h>=g.length?-1:h-1;if(a!=m||h!=j)m=a,j=h,-1==a||-1==h?c.cell=null:(f===x&&(f=a,l=h),c.cell={row:a,col:h,top:e[a],left:g[h],width:g[h+1]-g[h], height:e[a+1]-e[a],origRow:f,origCol:l,isOrig:a==f&&h==l,rowDelta:a-f,colDelta:h-l}),d(c.cell)};c.rect=function(a,b,c,d,f){f=f.offset();return{top:e[a]-f.top,left:g[b]-f.left,width:g[d]-g[b],height:e[c]-e[a]}}}function Z(a){return(10>a?"0":"")+a}function Da(a,b){if(a[b]!==x)return a[b];for(var d=b.split(/(?=[A-Z])/),c=d.length-1,e;0<=c;c--)if(e=a[d[c].toLowerCase()],e!==x)return e;return a[""]}function ja(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g, "&quot;")}function Ha(a){var b=this,d={},c={},e={};b.left=function(b){return c[b]=c[b]===x?(d[b]=d[b]||a(b)).position().left:c[b]};b.right=function(c){return e[c]=e[c]===x?b.left(c)+(d[c]=d[c]||a(c)).width():e[c]};b.clear=function(){d={};c={};e={}}}function Ma(a){return a.id+"/"+a.className+"/"+a.style.cssText.replace(/(^|;)\s*(top|left|width|height)\s*:[^;]*/ig,"")}function Wa(a,b){return a-b}function ka(a){if(a.end){var b=a.end;a=a.allDay;b=l(b);return a||b.getHours()||b.getMinutes()?m(b,1):b}return m(l(a.start), 1)}function Ja(a){a.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}var Q=h.fullCalendar={},ba=Q.views={},qa={defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,allDayDefault:!0,lazyFetching:!0,startParam:"start",endParam:"end",titleFormat:{month:"MMMM yyyy",week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:"dddd, MMM d, yyyy"},columnFormat:{month:"ddd",week:"ddd M/d",day:"dddd M/d"},timeFormat:{"":"h(:mm)t"}, isRTL:!1,firstDay:1,monthNames:"Enero Febrero Marzo Abril Mayo Junio Julio Agosto Septiembre Octubre Noviembre Diciembre".split(" "),monthNamesShort:"Ene Feb Mar Abr May Jun Jul Ago Sep Oct Nov Dic".split(" "),dayNames:"Domingo Lunes Martes Mi\u00e9rcoles Jueves Viernes S\u00e1bado".split(" "),dayNamesShort:"Dom Lun Mar Mi\u00e9 Jue Vie S\u00e1b".split(" "),buttonText:{prev:"&nbsp;&#9668;&nbsp;",next:"&nbsp;&#9658;&nbsp;",prevYear:"&nbsp;&lt;&lt;&nbsp;",nextYear:"&nbsp;&gt;&gt;&nbsp;",today:"Hoy", month:"mes",week:"semana",day:"d\u00eda"},theme:!1,buttonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e"},unselectAuto:!0},Za={header:{left:"next,prev today",center:"",right:"title"},buttonText:{prev:"&nbsp;&#9658;&nbsp;",next:"&nbsp;&#9668;&nbsp;",prevYear:"&nbsp;&gt;&gt;&nbsp;",nextYear:"&nbsp;&lt;&lt;&nbsp;"},buttonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w"}},Sa=Q.setDefaults=function(a){h.extend(!0,qa,a)};h.fn.fullCalendar=function(a){if("string"==typeof a){var b=Array.prototype.slice.call(arguments, 1),d;this.each(function(){var c=h.data(this,"fullCalendar");if(c&&(c=c[a]))c=c.apply(this,b),d===x&&(d=c)});return d!==x?d:this}var c=a.eventSources||[];delete a.eventSources;a.events&&(c.push(a.events),delete a.events);c.unshift([]);a=h.extend(!0,{},qa,a.isRTL||a.isRTL===x&&qa.isRTL?Za:{},a);var e=a.theme?"ui":"fc";this.each(function(){function b(c){if(c!=W){B++;k&&k.unselect();var g=k,j;g?(g.eventsChanged&&(E(),g.eventDirty=g.eventsChanged=!1),g.beforeHide&&g.beforeHide(),Ca(C,C.height()),g.element.hide()): Ca(C,1);C.css("overflow","hidden");U[c]?(k=U[c]).element.show():k=U[c]=Q.views[c](j=z=h("<div class='fc-view fc-view-"+c+"' style='position:absolute'/>").appendTo(C),a);R&&(R.find("div.fc-button-"+W).removeClass(e+"-state-active"),R.find("div.fc-button-"+c).addClass(e+"-state-active"));k.name=W=c;d();C.css("overflow","");g&&Ca(C,1);!j&&k.afterShow&&k.afterShow();B--}}function d(b){if(0!==D.offsetWidth){B++;k&&k.unselect();V===x&&w();if(!k.start||b||t<k.start||t>=k.end)k.render(t,b||0),M(!0),!X||!a.lazyFetching|| k.visStart<X||k.visEnd>P?q():k.renderEvents(N);else if(k.sizeDirty||k.eventsDirty||!a.lazyFetching)k.clearEvents(),k.sizeDirty&&M(),a.lazyFetching?k.renderEvents(N):q();u=v.outerWidth();k.sizeDirty=!1;k.eventsDirty=!1;R&&(R.find("h2.fc-header-title").html(k.title),b=new Date,b>=k.start&&b<k.end?R.find("div.fc-button-today").addClass(e+"-state-disabled"):R.find("div.fc-button-today").removeClass(e+"-state-disabled"));B--;k.trigger("viewDisplay",D)}}function F(){E();0!==D.offsetWidth&&(k.clearEvents(), k.renderEvents(N),k.eventsDirty=!1)}function E(){h.each(U,function(){this.eventsDirty=!0})}function j(){y();0!==D.offsetWidth&&(w(),M(),k&&k.unselect(),k.rerenderEvents(),k.sizeDirty=!1)}function y(){h.each(U,function(){this.sizeDirty=!0})}function p(a){N=[];X=l(k.visStart);P=l(k.visEnd);for(var b=c.length,d=function(){--b||a&&a(N)},e=0;e<c.length;e++)K(c[e],d)}function K(b,d){var e=k.name,f=l(t),g=function(g){if(e==k.name&&+f==+t&&-1!=h.inArray(b,c)){for(var j=0;j<g.length;j++)ca(g[j],a),g[j].source= b;N=N.concat(g);d&&d(g)}},j=function(a){g(a);--Z||k.trigger("loading",D,!1)};if("string"==typeof b){var m={};m[a.startParam]=Math.round(X.getTime()/1E3);m[a.endParam]=Math.round(P.getTime()/1E3);a.cacheParam&&(m[a.cacheParam]=(new Date).getTime());S();h.ajax({url:b,dataType:"json",data:m,cache:a.cacheParam||!1,success:j})}else h.isFunction(b)?(S(),b(l(X),l(P),j)):g(b)}function q(){p(function(a){k.renderEvents(a)})}function S(){Z++||k.trigger("loading",D,!0)}function r(c){if(c){var d=h("<tr/>");h.each(c.split(" "), function(c){0<c&&d.append("<td><span class='fc-header-space'/></td>");var f;h.each(this.split(","),function(c,j){if("title"==j)d.append("<td><h2 class='fc-header-title'>&nbsp;</h2></td>"),f&&f.addClass(e+"-corner-right"),f=null;else{var n;$[j]?n=$[j]:ba[j]&&(n=function(){k.removeClass(e+"-state-hover");b(j)});if(n){f&&f.addClass(e+"-no-right");var k,l=a.theme?Da(a.buttonIcons,j):null,m=Da(a.buttonText,j);l?k=h("<div class='fc-button-"+j+" ui-state-default'><a><span class='ui-icon ui-icon-"+l+"'/></a></div>"): m&&(k=h("<div class='fc-button-"+j+" "+e+"-state-default'><a><span>"+m+"</span></a></div>"));k&&(k.click(function(){k.hasClass(e+"-state-disabled")||n()}).mousedown(function(){k.not("."+e+"-state-active").not("."+e+"-state-disabled").addClass(e+"-state-down")}).mouseup(function(){k.removeClass(e+"-state-down")}).hover(function(){k.not("."+e+"-state-active").not("."+e+"-state-disabled").addClass(e+"-state-hover")},function(){k.removeClass(e+"-state-hover").removeClass(e+"-state-down")}).appendTo(h("<td/>").appendTo(d)), f?f.addClass(e+"-no-right"):k.addClass(e+"-corner-left"),f=k)}}});f&&f.addClass(e+"-corner-right")});return h("<table/>").append(d)}}function w(){V=a.contentHeight?a.contentHeight:a.height?a.height-(R?R.height():0)-ya(C[0]):Math.round(C.width()/Math.max(a.aspectRatio,0.5))}function M(a){B++;k.setHeight(V,a);z&&(z.css("position","relative"),z=null);k.setWidth(C.width(),a);B--}function J(){if(!B)if(k.start){var a=++H;setTimeout(function(){if(a==H&&(!B&&0!==D.offsetWidth)&&u!=(u=v.outerWidth()))B++, j(),k.trigger("windowResize",D),B--},200)}else L()}function L(){setTimeout(function(){!k.start&&0!==h("body")[0].offsetWidth&&d()},0)}var D=this,v=h(D).addClass("fc"),u,C=h("<div class='fc-content "+e+"-widget-content' style='position:relative'/>").prependTo(D),V,H=0,B=0,t=new Date,W,k,U={},z;a.isRTL&&v.addClass("fc-rtl");a.theme&&v.addClass("ui-widget");a.year!==x&&a.year!=t.getFullYear()&&(t.setDate(1),t.setMonth(0),t.setFullYear(a.year));a.month!==x&&a.month!=t.getMonth()&&(t.setDate(1),t.setMonth(a.month)); a.date!==x&&t.setDate(a.date);var N=[],X,P,Z=0,$={render:function(){w();y();E();d()},changeView:b,getView:function(){return k},getDate:function(){return t},option:function(b,c){if(c===x)return a[b];if("height"==b||"contentHeight"==b||"aspectRatio"==b)a[b]=c,j()},destroy:function(){h(window).unbind("resize",J);R&&R.remove();C.remove();h.removeData(D,"fullCalendar")},prev:function(){d(-1)},next:function(){d(1)},prevYear:function(){za(t,-1);d()},nextYear:function(){za(t,1);d()},today:function(){t=new Date; d()},gotoDate:function(a,b,c){"object"==typeof a?t=l(a):(a!==x&&t.setFullYear(a),b!==x&&t.setMonth(b),c!==x&&t.setDate(c));d()},incrementDate:function(a,b,c){a!==x&&za(t,a);b!==x&&Aa(t,b);c!==x&&m(t,c);d()},updateEvent:function(b){var c,d=N.length,e,f=b.start-b._start,g=b.end?b.end-(b._end||k.defaultEventEnd(b)):0;for(c=0;c<d;c++)e=N[c],e._id==b._id&&e!=b&&(e.start=new Date(+e.start+f),e.end=b.end?e.end?new Date(+e.end+g):new Date(+k.defaultEventEnd(e)+g):null,e.title=b.title,e.url=b.url,e.allDay= b.allDay,e.className=b.className,e.editable=b.editable,ca(e,a));ca(b,a);F()},renderEvent:function(b,d){ca(b,a);b.source||(d&&(b.source=c[0]).push(b),N.push(b));F()},removeEvents:function(a){if(a){if(!h.isFunction(a)){var b=a+"";a=function(a){return a._id==b}}N=h.grep(N,a,!0);for(d=0;d<c.length;d++)"object"==typeof c[d]&&(c[d]=h.grep(c[d],a,!0))}else{N=[];for(var d=0;d<c.length;d++)"object"==typeof c[d]&&(c[d]=[])}F()},clientEvents:function(a){return h.isFunction(a)?h.grep(N,a):a?(a+="",h.grep(N,function(b){return b._id== a})):N},rerenderEvents:F,addEventSource:function(a){c.push(a);K(a,F)},removeEventSource:function(a){c=h.grep(c,function(b){return b!=a});N=h.grep(N,function(b){return b.source!=a});F()},refetchEvents:function(){p(F)},select:function(a,b,c){k.select(a,b,c===x?!0:c)},unselect:function(){k.unselect()}};h.data(this,"fullCalendar",$);var R,I=a.header;I&&(R=h("<table class='fc-header'/>").append(h("<tr/>").append(h("<td class='fc-header-left'/>").append(r(I.left))).append(h("<td class='fc-header-center'/>").append(r(I.center))).append(h("<td class='fc-header-right'/>").append(r(I.right)))).prependTo(v)); h(window).resize(J);b(a.defaultView);0===h("body")[0].offsetWidth&&L()});return this};var Ta=0;Sa({weekMode:"fixed"});ba.month=function(a,b){return new ra(a,b,{render:function(a,c){c&&(Aa(a,c),a.setDate(1));var e=this.start=l(a,!0);e.setDate(1);this.end=Aa(l(e),1);var g=this.visStart=l(e),f=this.visEnd=l(this.end),h=b.weekends?0:1;h&&(K(g),K(f,-1,!0));m(g,-((g.getDay()-Math.max(b.firstDay,h)+7)%7));m(f,(7-f.getDay()+Math.max(b.firstDay,h))%7);g=Math.round((f-g)/(7*Ra));"fixed"==b.weekMode&&(m(f,7* (6-g)),g=6);this.title=S(e,this.option("titleFormat"),b);this.renderGrid(g,b.weekends?7:5,this.option("columnFormat"),!0)}})};ba.basicWeek=function(a,b){return new ra(a,b,{render:function(a,c){c&&m(a,7*c);var e=this.visStart=l(this.start=m(l(a),-((a.getDay()-b.firstDay+7)%7))),g=this.visEnd=l(this.end=m(l(e),7));b.weekends||(K(e),K(g,-1,!0));this.title=ea(e,m(l(g),-1),this.option("titleFormat"),b);this.renderGrid(1,b.weekends?7:5,this.option("columnFormat"),!1)}})};ba.basicDay=function(a,b){return new ra(a, b,{render:function(a,c){c&&(m(a,c),b.weekends||K(a,0>c?-1:1));this.title=S(a,this.option("titleFormat"),b);this.start=this.visStart=l(a,!0);this.end=this.visEnd=m(l(this.start),1);this.renderGrid(1,1,this.option("columnFormat"),!1)}})};var ua;Sa({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:0.5},minTime:0,maxTime:24});ba.agendaWeek=function(a,b){return new Oa(a,b,{render:function(a, c){c&&m(a,7*c);var e=this.visStart=l(this.start=m(l(a),-((a.getDay()-b.firstDay+7)%7))),g=this.visEnd=l(this.end=m(l(e),7));b.weekends||(K(e),K(g,-1,!0));this.title=ea(e,m(l(g),-1),this.option("titleFormat"),b);this.renderAgenda(b.weekends?7:5,this.option("columnFormat"))}})};ba.agendaDay=function(a,b){return new Oa(a,b,{render:function(a,c){c&&(m(a,c),b.weekends||K(a,0>c?-1:1));this.title=S(a,this.option("titleFormat"),b);this.start=this.visStart=l(a,!0);this.end=this.visEnd=m(l(this.start),1);this.renderAgenda(1, this.option("columnFormat"))}})};var Ia={init:function(a,b){this.element=a;this.options=b;this.eventsByID={};this.eventElements=[];this.eventElementsByID={};this.usedOverlays=[];this.unusedOverlays=[]},trigger:function(a,b){if(this.options[a])return this.options[a].apply(b||this,Array.prototype.slice.call(arguments,2).concat([this]))},eventEnd:function(a){return a.end?l(a.end):this.defaultEventEnd(a)},reportEvents:function(a){var b,d=a.length,c,e=this.eventsByID={};for(b=0;b<d;b++)c=a[b],e[c._id]? e[c._id].push(c):e[c._id]=[c]},reportEventElement:function(a,b){this.eventElements.push(b);var d=this.eventElementsByID;d[a._id]?d[a._id].push(b):d[a._id]=[b]},_clearEvents:function(){this.eventElements=[];this.eventElementsByID={}},showEvents:function(a,b){this._eee(a,b,"show")},hideEvents:function(a,b){this._eee(a,b,"hide")},_eee:function(a,b,d){a=this.eventElementsByID[a._id];var c,e=a.length;for(c=0;c<e;c++)if(a[c][0]!=b[0])a[c][d]()},eventDrop:function(a,b,d,c,e,g,f){var h=this,l=b.allDay,j= b._id;h.moveEvents(h.eventsByID[j],d,c,e);h.trigger("eventDrop",a,b,d,c,e,function(){h.moveEvents(h.eventsByID[j],-d,-c,l);h.rerenderEvents()},g,f);h.eventsChanged=!0;h.rerenderEvents(j)},eventResize:function(a,b,d,c,e,g){var f=this,h=b._id;f.elongateEvents(f.eventsByID[h],d,c);f.trigger("eventResize",a,b,d,c,function(){f.elongateEvents(f.eventsByID[h],-d,-c);f.rerenderEvents()},e,g);f.eventsChanged=!0;f.rerenderEvents(h)},moveEvents:function(a,b,d,c){d=d||0;for(var e,g=a.length,f=0;f<g;f++)e=a[f], c!==x&&(e.allDay=c),E(m(e.start,b,!0),d),e.end&&(e.end=E(m(e.end,b,!0),d)),ca(e,this.options)},elongateEvents:function(a,b,d){d=d||0;for(var c,e=a.length,g=0;g<e;g++)c=a[g],c.end=E(m(this.eventEnd(c),b,!0),d),ca(c,this.options)},renderOverlay:function(a,b){var d=this.unusedOverlays.shift();d||(d=h("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>"));d[0].parentNode!=b[0]&&d.appendTo(b);this.usedOverlays.push(d.css(a).show());return d},clearOverlays:function(){for(var a;a=this.usedOverlays.shift();)this.unusedOverlays.push(a.hide().unbind())}, resizableDayEvent:function(a,b,d){var c=this;!c.options.disableResizing&&b.resizable&&b.resizable({handles:c.options.isRTL?{w:"div.ui-resizable-w"}:{e:"div.ui-resizable-e"},grid:d,minWidth:d/2,containment:c.element.parent().parent(),start:function(d,g){b.css("z-index",9);c.hideEvents(a,b);c.trigger("eventResizeStart",this,a,d,g)},stop:function(e,g){c.trigger("eventResizeStop",this,a,e,g);var f=Math.round((b.width()-g.originalSize.width)/d);f?c.eventResize(this,a,f,0,e,g):(b.css("z-index",8),c.showEvents(a, b))}})},eventElementHandlers:function(a,b){var d=this;b.click(function(c){if(!b.hasClass("ui-draggable-dragging")&&!b.hasClass("ui-resizable-resizing"))return d.trigger("eventClick",this,a,c)}).hover(function(b){d.trigger("eventMouseover",this,a,b)},function(b){d.trigger("eventMouseout",this,a,b)})},option:function(a,b){var d=this.options[a];return"object"==typeof d?Da(d,b||this.name):d},sliceSegs:function(a,b,d,c){var e=[],g,f=a.length,h,m,j,y,p;for(g=0;g<f;g++)h=a[g],m=h.start,j=b[g],j>d&&m<c&& (m<d?(m=l(d),y=!1):y=!0,j>c?(j=l(c),p=!1):p=!0,e.push({event:h,start:m,end:j,isStart:y,isEnd:p,msLength:j-m}));return e.sort(Va)}},Ra=864E5,Xa=36E5,Ua=6E4;Q.addDays=m;Q.cloneDate=l;var Ea=Q.parseDate=function(a){return"object"==typeof a?a:"number"==typeof a?new Date(1E3*a):"string"==typeof a?a.match(/^\d+$/)?new Date(1E3*parseInt(a)):$a(a,!0)||(a?new Date(a):null):null},$a=Q.parseISO8601=function(a,b){var d=a.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?$/); if(!d)return null;var c=new Date(d[1],0,1),e=new Date(d[1],0,1,9,0),g=0;d[3]&&(c.setMonth(d[3]-1),e.setMonth(d[3]-1));d[5]&&(c.setDate(d[5]),e.setDate(d[5]));Ba(c,e);d[7]&&c.setHours(d[7]);d[8]&&c.setMinutes(d[8]);d[10]&&c.setSeconds(d[10]);d[12]&&c.setMilliseconds(1E3*Number("0."+d[12]));Ba(c,e);b||(d[14]&&(g=60*Number(d[16])+Number(d[17]),g*="-"==d[15]?1:-1),g-=c.getTimezoneOffset());return new Date(+c+6E4*g)},Qa=Q.parseTime=function(a){if("number"==typeof a)return 60*a;if("object"==typeof a)return 60* a.getHours()+a.getMinutes();if(a=a.match(/(\d+)(?::(\d+))?\s*(\w+)?/)){var b=parseInt(a[1]);a[3]&&(b%=12,"p"==a[3].toLowerCase().charAt(0)&&(b+=12));return 60*b+(a[2]?parseInt(a[2]):0)}},S=Q.formatDate=function(a,b,d){return ea(a,null,b,d)},ea=Q.formatDates=function(a,b,d,c){c=c||qa;var e=a,g=b,f,h=d.length,l,j,m,p="";for(f=0;f<h;f++)if(l=d.charAt(f),"'"==l)for(j=f+1;j<h;j++){if("'"==d.charAt(j)){e&&(p=j==f+1?p+"'":p+d.substring(f+1,j),f=j);break}}else if("("==l)for(j=f+1;j<h;j++){if(")"==d.charAt(j)){f= S(e,d.substring(f+1,j),c);parseInt(f.replace(/\D/,""))&&(p+=f);f=j;break}}else if("["==l)for(j=f+1;j<h;j++){if("]"==d.charAt(j)){l=d.substring(f+1,j);f=S(e,l,c);f!=S(g,l,c)&&(p+=f);f=j;break}}else if("{"==l)e=b,g=a;else if("}"==l)e=a,g=b;else{for(j=h;j>f;j--)if(m=ab[d.substring(f,j)]){e&&(p+=m(e,c));f=j-1;break}j==f&&e&&(p+=l)}return p},ab={s:function(a){return a.getSeconds()},ss:function(a){return Z(a.getSeconds())},m:function(a){return a.getMinutes()},mm:function(a){return Z(a.getMinutes())},h:function(a){return a.getHours()% 12||12},hh:function(a){return Z(a.getHours()%12||12)},H:function(a){return a.getHours()},HH:function(a){return Z(a.getHours())},d:function(a){return a.getDate()},dd:function(a){return Z(a.getDate())},ddd:function(a,b){return b.dayNamesShort[a.getDay()]},dddd:function(a,b){return b.dayNames[a.getDay()]},M:function(a){return a.getMonth()+1},MM:function(a){return Z(a.getMonth()+1)},MMM:function(a,b){return b.monthNamesShort[a.getMonth()]},MMMM:function(a,b){return b.monthNames[a.getMonth()]},yy:function(a){return(a.getFullYear()+ "").substring(2)},yyyy:function(a){return a.getFullYear()},t:function(a){return 12>a.getHours()?"a":"p"},tt:function(a){return 12>a.getHours()?"am":"pm"},T:function(a){return 12>a.getHours()?"A":"P"},TT:function(a){return 12>a.getHours()?"AM":"PM"},u:function(a){return S(a,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(a){a=a.getDate();return 10<a&&20>a?"th":["st","nd","rd"][a%10-1]||"th"}},pa,x,W="sun mon tue wed thu fri sat".split(" ")})(jQuery);